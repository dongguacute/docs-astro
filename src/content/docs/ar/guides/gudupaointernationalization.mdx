---
title: البرنامج المساعد Gudupao Astro I18n
sidebar:
 label: البرنامج المساعد Gudupao Astro I18n
description: البرنامج المساعد i18n لـ Astro مع دعم لـ {{t.xxx}} وحزم اللغات المحلية وتبديل اللغة والتوافق مع SSR وSSG.
i18nReady: true
---

يوفر مكوننا الإضافي حلاً كاملاً لـ i18n لمشاريع Astro، مصمم ليكون بديهيًا وقويًا:

- توجيه متعدد اللغات مرن: يدعم التوجيه القائم على المسار وبدون مسار.
- كشف اللغة التلقائي: يكتشف لغة متصفح المستخدم مع عمليات تراجع أنيقة.
- حزم لغات قابلة للتخصيص: تسمح للمطورين بتعريف وتنظيم الترجمات في ملفات JSON المحلية.
- بناء جملة ترجمة بسيطة: يمكن الوصول إلى الترجمات باستخدام \{\{t.xxx\}\} للوضوح وسهولة الصيانة.
- تبديل اللغة السلس: يتيح تغييرات اللغة في وقت التشغيل دون تعقيد.
- توافق الأوضاع: يدعم كليًا أوضاع SSR (الديناميكية) وSSG (الثابتة) الخاصة بـ Astro.
- دعم عبر الأطر: يعمل مع لغات التأليف الثلاث الرئيسية الخاصة بـ Astro — Astro وReact وVue.

## التثبيت

```
pnpm add @gudupao/astro-i18n
```



## التكوين

### نظرة عامة

يمكن تكوين Astro-i18n مع خيارات متنوعة لتخصيص سلوكه. يوضح هذا المستند كل خيار تكوين وغرضه والقيمة الافتراضية.

يدعم Astro-i18n طريقتين رئيسيتين للتشغيل:
- **قائم على المسار**: تُحدد اللغات بواسطة مسارات URL (على سبيل المثال، `/en/about`، `/zh/about`). يتم التحكم في هذا بواسطة خيار `pathBasedRouting`.
- **بدون مسار**: تُحدد اللغة بوسائل أخرى (ملف تعريف الارتباط، رأس Accept-Language) دون تغيير مسار URL. يتم التحكم في هذا أيضًا بواسطة خيار `pathBasedRouting`.

### خيارات التكوين الشائعة

هذه الخيارات متوفرة لكل من الوضع القائم على المسار والوضع بدون مسار.

#### `localesDir`

- **النوع**: `string`
- **الوصف**: الدليل الذي يتم فيه تخزين ملفات الإعدادات المحلية الخاصة بك.
- **الافتراضي**: `'locales'`

مثال:
```typescript
integrations: [
  astroI18nPlugin({
    localesDir: './my-locales'
 })
]
```

#### `fallbackLang`

- **النوع**: `string`
- **الوصف**: اللغة التي يتم التراجع إليها إذا لم يتم العثور على ترجمة للغة الحالية.
- **الافتراضي**: `'en'`

مثال:
```typescript
integrations: [
 astroI18nPlugin({
    fallbackLang: 'zh'
  })
]
```

#### `autoDetectLanguage`

- **النوع**: `boolean`
- **الوصف**: ما إذا كان سيتم اكتشاف لغة المستخدم تلقائيًا من رأس Accept-Language.
- **الافتراضي**: `true`

مثال (مع الكشف التلقائي):
```typescript
integrations: [
  astroI18nPlugin({
    autoDetectLanguage: true
  })
]
```

مثال (بدون الكشف التلقائي):
```typescript
integrations: [
  astroI18nPlugin({
    autoDetectLanguage: false
  })
]
```

#### `pathBasedRouting`

- **النوع**: `boolean`
- **الوصف**: ما إذا كان سيتم استخدام التوجيه القائم على المسار. إذا كان `true`، تُحدد اللغات بواسطة مسارات URL (على سبيل المثال، `/en/about`، `/zh/about`). إذا كان `false`، تُحدد اللغة بوسائل أخرى (ملف تعريف الارتباط، رأس Accept-Language) دون تغيير مسار URL.
- **الافتراضي**: `true`

يحدد هذا الخيار وضع التشغيل:
- `true` (الافتراضي): الوضع القائم على المسار.
- `false`: الوضع بدون مسار.

مثال (قائم على المسار):
```typescript
integrations: [
  astroI18nPlugin({
    pathBasedRouting: true
  })
]
```

مثال (بدون مسار):
```typescript
integrations: [
  astroI18nPlugin({
    pathBasedRouting: false
  })
]
```

### تكوين الوضع القائم على المسار (pathBasedRouting: true)

عندما يكون `pathBasedRouting` `true`، يعمل Astro-i18n في الوضع القائم على المسار. تنطبق جميع خيارات التكوين الشائعة.

### تكوين الوضع بدون مسار (pathBasedRouting: false)

عندما يكون `pathBasedRouting` `false`، يعمل Astro-i18n في الوضع بدون مسار. تنطبق جميع خيارات التكوين الشائعة.

الفرق الرئيسي هو في كيفية تحديد اللغة وكيفية التعامل مع عناوين URL:
- في الوضع القائم على المسار، تكون اللغة جزءًا من مسار URL.
- في الوضع بدون مسار، تُحدد اللغة بوسائل أخرى (ملف تعريف الارتباط، رأس Accept-Language) ويظل مسار URL دون تغيير.

## الاستخدام


### Astro

```astro
---
import { getTranslator } from '@gudupao/astro-i18n';

// الحصول على اللغة من المعلمات
const lang = Astro.params.lang || 'en';
const t = getTranslator(lang);
---

<div>
  <h1>اختبار Astro: {t('hello')} {t('123.a')}</h1>
</div>
```

### React

```jsx
import React from 'react';
import { createClientTranslator } from '@gudupao/astro-i18n';
import type { Translations } from '@gudupao/astro-i18n';

const TestComponent = ({ translations }: { translations: Translations }) => {
  const t = createClientTranslator(translations);
  
  return (
    <div>
      <h1>اختبار React: {t('hello')} {t('123.a')}</h1>
    </div>
  );
};

export default TestComponent;
```

### Vue

```vue
<template>
 <div>
    <h1>اختبار Vue: {{ t('hello') }} {{ t('123.a') }}</h1>
  </div>
</template>

<script setup lang="ts">
import { createClientTranslator } from '@gudupao/astro-i18n';
import type { Translations } from '@gudupao/astro-i18n';

interface Props {
  translations: Translations;
}

const props = defineProps<Props>();
const t = createClientTranslator(props.translations);
</script>
```

## أمثلة محوّل اللغة

### الإصدار القائم على المسار

```astro
---
interface Props {
  lang: string;
}

const { lang } = Astro.props;
---

<script is:inline>
 function switchLanguage(language) {
    // تعيين ملف تعريف الارتباط للغة
    document.cookie = `lang=${language}; path=/; max-age=31536000; samesite=lax`;
    console.log('[LanguageSwitcher] تعيين ملف تعريف الارتباط للغة:', language);
    
    const urlParts = window.location.pathname.split('/');
    urlParts[1] = language;
    window.location.href = urlParts.join('/');
  }

  const currentPath = window.location.pathname;
  const urlParts = currentPath.split('/');
</script>

<div class="language-switcher">
  <button
    onclick="switchLanguage('en')"
    class={lang === 'en' ? 'active' : ''}
  >
    English
  </button>
  <button
    onclick="switchLanguage('zh')"
    class={lang === 'zh' ? 'active' : ''}
  >
    中文
  </button>
    <button
    onclick="switchLanguage('jp')"
    class={lang === 'jp' ? 'active' : ''}
  >
    日本語
  </button>
</div>

<style>
.language-switcher {
  display: flex;
  gap: 10px;
  margin-top: 20px;
}

.language-switcher button {
  padding: 5px 10px;
  border: none;
  background: #f0f0f0;
  border-radius: 5px;
  cursor: pointer;
}

.language-switcher button.active {
  background: #007bff;
  color: white;
}
</style>
```

### الإصدار بدون مسار

```astro
---
// الحصول على جميع اللغات المتوفرة
const { getAvailableLanguages } = await import('@gudupao/astro-i18n');
const availableLanguages = getAvailableLanguages();

interface Props {
  pathBasedRouting?: boolean; // ما إذا كان سيتم استخدام وضع التوجيه القائم على المسار
}

const { pathBasedRouting = true } = Astro.props;

// دالة للكشف عن اللغة الحالية
function detectCurrentLanguage() {
  // التحقق من معلمات URL أولاً
  const urlParams = new URLSearchParams(Astro.url.search);
  const langParam = urlParams.get('lang');
  if (langParam) return langParam;

  // ثم التحقق من ملف تعريف الارتباط
  const cookies = Astro.request.headers.get('cookie');
  if (cookies) {
    const cookieObj = Object.fromEntries(
      cookies.split(';').map(cookie => {
        const [name, value] = cookie.trim().split('=');
        return [name, decodeURIComponent(value)];
      })
    );
    if (cookieObj.lang) return cookieObj.lang;
 }

  // إرجاع اللغة الافتراضية
  return 'en';
}

// الحصول على اللغة الحالية
const currentLang = detectCurrentLanguage();
---

<div class="language-switcher">
  <h3>محوّل اللغة (الإصدار الجديد)</h3>
  <p>الوضع الحالي: {pathBasedRouting ? 'التوجيه القائم على المسار' : 'التوجيه بدون مسار'}</p>
  <div class="switcher-buttons">
    {availableLanguages.map((language) => (
      <button
        data-lang={language}
        class={language === currentLang ? 'active' : ''}
        onclick={`switchLanguage('${language}', ${pathBasedRouting})`}
      >
        {language === 'en' && 'English'}
        {language === 'zh' && '中文'}
        {language === 'jp' && '日本語'}
        {language !== 'en' && language !== 'zh' && language !== 'jp' && language}
      </button>
    ))}
  </div>
</div>

<script is:inline>
  // دالة لتبديل اللغة
  function switchLanguage(language, pathBasedRouting) {
    if (pathBasedRouting) {
      // وضع التوجيه القائم على المسار
      // تعيين ملف تعريف الارتباط للغة
      document.cookie = `lang=${language}; path=/; max-age=31536000; samesite=lax`;
      console.log('[LanguageSwitcher] تعيين ملف تعريف الارتباط للغة:', language);
      
      const urlParts = window.location.pathname.split('/');
      urlParts[1] = language;
      window.location.href = urlParts.join('/');
    } else {
      // وضع التوجيه بدون مسار
      // تعيين ملف تعريف الارتباط للغة
      document.cookie = `lang=${language}; path=/; max-age=31536000; samesite=lax`;
      // تعيين localStorage
      localStorage.setItem('lang', language);
      // إعادة تحميل الصفحة لتطبيق اللغة الجديدة
      window.location.reload();
    }
  }
</script>

<style>
.language-switcher {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin: 20px 0;
  padding: 15px;
  border: 1px solid #ddd;
  border-radius: 5px;
  background-color: #f9;
}

.switcher-buttons {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.language-switcher button {
  padding: 8px 12px;
  border: none;
  background: #f0f0f0;
  border-radius: 5px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.language-switcher button:hover {
  background: #e0e0e0;
}

.language-switcher button.active {
  background: #007bff;
  color: white;
}

.language-switcher h3 {
  margin: 0 0 10px 0;
  font-size: 16px;
  color: #333;
}

.language-switcher p {
  margin: 0 0 10px 0;
  font-size: 14px;
  color: #666;
}
</style>
```

## الروابط

- مستودع الكود المصدر: [https://github.com/GudupaoSpark/Astro-i18n](https://github.com/GudupaoSpark/Astro-i18n)
- npmjs: [https://www.npmjs.com/package/@gudupao/astro-i18n](https://www.npmjs.com/package/@gudupao/astro-i18n)
- الوثائق الأصلية: [https://astro-i18n.gudupao.top](https://astro-i18n.gudupao.top)
