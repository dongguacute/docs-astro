---
title: Plugin Gudupao Astro I18n
sidebar:
 label: Plugin Gudupao Astro I18n
description: Plugin i18n para Astro com suporte para {{t.xxx}}, pacotes de idiomas locais, troca de idioma e compatibilidade com SSR e SSG.
i18nReady: true
---

Nosso plugin fornece uma solução i18n completa para projetos Astro, projetada para ser intuitiva e poderosa:

- Roteamento multilíngue flexível: suporta roteamento baseado em caminho e sem caminho.
- Detecção automática de idioma: detecta o idioma do navegador do usuário com fallbacks elegantes.
- Pacotes de idiomas personalizáveis: permitem que os desenvolvedores definam e organizem traduções em arquivos JSON locais.
- Sintaxe de tradução simples: as traduções podem ser acessadas usando \{\{t.xxx\}\} para clareza e manutenibilidade.
- Troca de idioma perfeita: permite alterações de idioma em tempo de execução sem complexidade.
- Compatibilidade de modos: suporta totalmente os modos SSR (dinâmico) e SSG (estático) do Astro.
- Suporte a múltiplos frameworks: funciona com as três principais linguagens de autoria do Astro — Astro, React e Vue.

## Instalação

```
pnpm add @gudupao/astro-i18n
```



## Configuração

### Visão geral

O Astro-i18n pode ser configurado com várias opções para personalizar seu comportamento. Este documento detalha cada opção de configuração, sua finalidade e valor padrão.

O Astro-i18n suporta dois modos principais de operação:
- **Baseado em caminho**: os idiomas são identificados por caminhos de URL (por exemplo, `/en/about`, `/zh/about`). Isso é controlado pela opção `pathBasedRouting`.
- **Sem caminho**: o idioma é determinado por outros meios (cookie, cabeçalho Accept-Language) sem alterar o caminho da URL. Isso também é controlado pela opção `pathBasedRouting`.

### Opções de configuração comuns

Essas opções estão disponíveis para os modos baseado em caminho e sem caminho.

#### `localesDir`

- **Tipo**: `string`
- **Descrição**: O diretório onde seus arquivos de localidade são armazenados.
- **Padrão**: `'locales'`

Exemplo:
```typescript
integrations: [
  astroI18nPlugin({
    localesDir: './my-locales'
 })
]
```

#### `fallbackLang`

- **Tipo**: `string`
- **Descrição**: O idioma para o qual retornar se uma tradução não for encontrada para o idioma atual.
- **Padrão**: `'en'`

Exemplo:
```typescript
integrations: [
 astroI18nPlugin({
    fallbackLang: 'zh'
  })
]
```

#### `autoDetectLanguage`

- **Tipo**: `boolean`
- **Descrição**: Se deve detectar automaticamente o idioma do usuário a partir do cabeçalho Accept-Language.
- **Padrão**: `true`

Exemplo (com detecção automática):
```typescript
integrations: [
  astroI18nPlugin({
    autoDetectLanguage: true
  })
]
```

Exemplo (sem detecção automática):
```typescript
integrations: [
  astroI18nPlugin({
    autoDetectLanguage: false
  })
]
```

#### `pathBasedRouting`

- **Tipo**: `boolean`
- **Descrição**: Se deve usar roteamento baseado em caminho. Se `true`, os idiomas são identificados por caminhos de URL (por exemplo, `/en/about`, `/zh/about`). Se `false`, o idioma é determinado por outros meios (cookie, cabeçalho Accept-Language) sem alterar o caminho da URL.
- **Padrão**: `true`

Esta opção determina o modo de operação:
- `true` (padrão): Modo baseado em caminho.
- `false`: Modo sem caminho.

Exemplo (Baseado em caminho):
```typescript
integrations: [
  astroI18nPlugin({
    pathBasedRouting: true
  })
]
```

Exemplo (Sem caminho):
```typescript
integrations: [
  astroI18nPlugin({
    pathBasedRouting: false
  })
]
```

### Configuração do modo baseado em caminho (pathBasedRouting: true)

Quando `pathBasedRouting` é `true`, o Astro-i18n opera no modo baseado em caminho. Todas as opções de configuração comuns se aplicam.

### Configuração do modo sem caminho (pathBasedRouting: false)

Quando `pathBasedRouting` é `false`, o Astro-i18n opera no modo sem caminho. Todas as opções de configuração comuns se aplicam.

A principal diferença está em como o idioma é determinado e como as URLs são tratadas:
- No modo baseado em caminho, o idioma faz parte do caminho da URL.
- No modo sem caminho, o idioma é determinado por outros meios (cookie, cabeçalho Accept-Language) e o caminho da URL permanece inalterado.

## Uso


### Astro

```astro
---
import { getTranslator } from '@gudupao/astro-i18n';

// Obter idioma dos parâmetros
const lang = Astro.params.lang || 'en';
const t = getTranslator(lang);
---

<div>
  <h1>Teste Astro: {t('hello')} {t('123.a')}</h1>
</div>
```

### React

```jsx
import React from 'react';
import { createClientTranslator } from '@gudupao/astro-i18n';
import type { Translations } from '@gudupao/astro-i18n';

const TestComponent = ({ translations }: { translations: Translations }) => {
  const t = createClientTranslator(translations);
  
  return (
    <div>
      <h1>Teste React: {t('hello')} {t('123.a')}</h1>
    </div>
  );
};

export default TestComponent;
```

### Vue

```vue
<template>
 <div>
    <h1>Teste Vue: {{ t('hello') }} {{ t('123.a') }}</h1>
  </div>
</template>

<script setup lang="ts">
import { createClientTranslator } from '@gudupao/astro-i18n';
import type { Translations } from '@gudupao/astro-i18n';

interface Props {
  translations: Translations;
}

const props = defineProps<Props>();
const t = createClientTranslator(props.translations);
</script>
```

## Exemplos de seletor de idioma

### Versão baseada em caminho

```astro
---
interface Props {
  lang: string;
}

const { lang } = Astro.props;
---

<script is:inline>
 function switchLanguage(language) {
    // Definir Cookie de idioma
    document.cookie = `lang=${language}; path=/; max-age=31536000; samesite=lax`;
    console.log('[LanguageSwitcher] Definir Cookie de idioma:', language);
    
    const urlParts = window.location.pathname.split('/');
    urlParts[1] = language;
    window.location.href = urlParts.join('/');
  }

  const currentPath = window.location.pathname;
  const urlParts = currentPath.split('/');
</script>

<div class="language-switcher">
  <button
    onclick="switchLanguage('en')"
    class={lang === 'en' ? 'active' : ''}
  >
    English
  </button>
  <button
    onclick="switchLanguage('zh')"
    class={lang === 'zh' ? 'active' : ''}
  >
    中文
  </button>
    <button
    onclick="switchLanguage('jp')"
    class={lang === 'jp' ? 'active' : ''}
  >
    日本語
  </button>
</div>

<style>
.language-switcher {
  display: flex;
  gap: 10px;
  margin-top: 20px;
}

.language-switcher button {
  padding: 5px 10px;
  border: none;
  background: #f0f0f0;
  border-radius: 5px;
  cursor: pointer;
}

.language-switcher button.active {
  background: #007bff;
  color: white;
}
</style>
```

### Versão sem caminho

```astro
---
// Obter todos os idiomas disponíveis
const { getAvailableLanguages } = await import('@gudupao/astro-i18n');
const availableLanguages = getAvailableLanguages();

interface Props {
  pathBasedRouting?: boolean; // Se deve usar o modo de roteamento baseado em caminho
}

const { pathBasedRouting = true } = Astro.props;

// Função para detectar o idioma atual
function detectCurrentLanguage() {
  // Primeiro verificar os parâmetros da URL
  const urlParams = new URLSearchParams(Astro.url.search);
  const langParam = urlParams.get('lang');
  if (langParam) return langParam;

  // Depois verificar o Cookie
  const cookies = Astro.request.headers.get('cookie');
  if (cookies) {
    const cookieObj = Object.fromEntries(
      cookies.split(';').map(cookie => {
        const [name, value] = cookie.trim().split('=');
        return [name, decodeURIComponent(value)];
      })
    );
    if (cookieObj.lang) return cookieObj.lang;
 }

  // Retornar o idioma padrão
  return 'en';
}

// Obter o idioma atual
const currentLang = detectCurrentLanguage();
---

<div class="language-switcher">
  <h3>Seletor de Idioma (Nova Versão)</h3>
  <p>Modo Atual: {pathBasedRouting ? 'Roteamento Baseado em Caminho' : 'Roteamento Sem Caminho'}</p>
  <div class="switcher-buttons">
    {availableLanguages.map((language) => (
      <button
        data-lang={language}
        class={language === currentLang ? 'active' : ''}
        onclick={`switchLanguage('${language}', ${pathBasedRouting})`}
      >
        {language === 'en' && 'English'}
        {language === 'zh' && '中文'}
        {language === 'jp' && '日本語'}
        {language !== 'en' && language !== 'zh' && language !== 'jp' && language}
      </button>
    ))}
  </div>
</div>

<script is:inline>
  // Função para trocar o idioma
  function switchLanguage(language, pathBasedRouting) {
    if (pathBasedRouting) {
      // Modo de roteamento baseado em caminho
      // Definir Cookie de idioma
      document.cookie = `lang=${language}; path=/; max-age=31536000; samesite=lax`;
      console.log('[LanguageSwitcher] Definir Cookie de idioma:', language);
      
      const urlParts = window.location.pathname.split('/');
      urlParts[1] = language;
      window.location.href = urlParts.join('/');
    } else {
      // Modo de roteamento sem caminho
      // Definir Cookie de idioma
      document.cookie = `lang=${language}; path=/; max-age=31536000; samesite=lax`;
      // Definir localStorage
      localStorage.setItem('lang', language);
      // Recarregar a página para aplicar o novo idioma
      window.location.reload();
    }
  }
</script>

<style>
.language-switcher {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin: 20px 0;
  padding: 15px;
  border: 1px solid #ddd;
  border-radius: 5px;
  background-color: #f9f9;
}

.switcher-buttons {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.language-switcher button {
  padding: 8px 12px;
  border: none;
  background: #f0f0f0;
  border-radius: 5px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.language-switcher button:hover {
  background: #e0e0e0;
}

.language-switcher button.active {
  background: #007bff;
  color: white;
}

.language-switcher h3 {
  margin: 0 0 10px 0;
  font-size: 16px;
  color: #333;
}

.language-switcher p {
  margin: 0 0 10px 0;
  font-size: 14px;
  color: #666;
}
</style>
```

## Links

- Repositório de código-fonte: [https://github.com/GudupaoSpark/Astro-i18n](https://github.com/GudupaoSpark/Astro-i18n)
- npmjs: [https://www.npmjs.com/package/@gudupao/astro-i18n](https://www.npmjs.com/package/@gudupao/astro-i18n)
- Documentação original: [https://astro-i18n.gudupao.top](https://astro-i18n.gudupao.top)
